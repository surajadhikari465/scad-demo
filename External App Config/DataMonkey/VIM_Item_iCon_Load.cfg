<?xml version="1.0" encoding="utf-8" ?>
<configuration>
<!--****************************************************************
 Config File: VIM_Item_Master.cfg
      Author: Ron Savage
        Date: 01/27/2014

 Description: 
 This job extracts the Item Master info from the VIM.

 Modification History: 
 Date       Init Comment
 01/27/2014 RS   Created.
******************************************************************-->
<!--********************************************************************
 Global Key Definitions
********************************************************************-->
   <config key="sqlTimeout"      value="1800"/>
   <config key="emailSMTPServer" value="smtp.wholefoods.com"/>
   <config key="LogFile"         value="/IRMA/logs/VIMItemIConLoad_{yyyy}{mm}{dd}.log"/>
   <config key="ParameterFile"   value="conf/VIM_Item_iCon_Load.prm"/>
   <config key="MaxEntries"      value="5"/>
   <config key="VIM_Item_File"   value="E:\Data\iConImport\VIMItemMaster.txt"/>

   <config key="maxBCPErrors"    value="10"/>
   <config key="IConServer"      value="cewd1815\SQLSHAREd2012D"/>
   <config key="IConuser"        value="iConUser"/>
   <config key="IConpass"        value="FILE:conn/iConUser_pass.txtx"/>
   <config key="ICon_Insert"     value="SYSTEM, bcp.exe,iCon.dbo.{TGT_NAME} in {VIM_Item_File} -S {IConServer} -U {IConuser} -P {IConpass} -t {q}|{q} -m {maxBCPErrors} -e {q}E:\Data\iConImport\{TGT_NAME}.err{q} -r= \n -c"/>
   
   <!-- Database ODBC Connection string keys -->
   <config key="VIM"             value="ORACLE,Data Source=VIMPRD;User Id=vim_user_icon;Password=v1mus3r1c0n;"/>
   <config key="ICON"            value="FILE:conn/iCon_Connection.txt"/>

<!--********************************************************************
 Delimiter Configurations
********************************************************************-->
   <config key="pipe"           value="|"/>

<!--********************************************************************
 Source / Target Entries
********************************************************************-->
   <config key="source_1"     value="DB, VIM, QUERY, item_master_qry, pipe, , "/>
   <config key="target_1"     value="FILE, REPLACE, {VIM_Item_File}, pipe, , ICon_Insert"/>

   <config key="item_master_qry"  value="
		select ltrim(to_char(im.nat_upc), '0'), im.long_description, im.pos_description,im.item_uom, b.brand_name, TO_CHAR(SYSDATE, 'DD-MON-YYYY HH:MI:SS') 
		  from VIM.item_master im 
     left join VIM.brand b on im.brand = b.brand  
	--where im.timestamp > (TO_DATE('{LAST_SQL_START}','YYYY/MM/DD HH24:MI:SS')) 
   "/>
  <!-- Comment out the line above for the initial load. This line is needed to load the delta. -->
   
</configuration>