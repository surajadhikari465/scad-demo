@model Icon.Web.Mvc.Models.BulkUploadViewModel
@{
    ViewBag.Title = "Bulk Upload";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@*@{Html.RenderPartial("_HeaderPartial", "Bulk Upload");}*@

<style type="text/css">
    .gridCenter {
        text-align: center
    }
</style>

@using (Html.BeginForm("BulkUpload", "Item", null, FormMethod.Post, new { enctype = "multipart/form-data", @class = "begin-form" }))
{
    @Html.AntiForgeryToken()
    @Html.ValidationSummary(true)
    <div id="uploadDiv">
        @if (ViewData["SuccessMessage"] != null)
        {
            <div class="alert alert-success alert-dismissable">
                <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
                <strong>@ViewData["SuccessMessage"].ToString()</strong>
            </div>
        }
        @if (ViewData["ErrorMessages"] != null)
        {
            <div class="alert alert-danger alert-dismissable">
                <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
                <ul>
                    @foreach (var message in (List<string>)ViewData["ErrorMessages"])
                    {
                        <li>@Html.Raw(message)</li>
                    }
                </ul>
            </div>
        }
    </div>

    <div class="container col-12">
        <div class="text-center py-3">
            <h2>Item Bulk Upload</h2>
            @*<p class="lead">Bulk Upload</p>*@
        </div>

        <div class="content">
            @Html.RadioButtonFor(model => model.NewOrExistSetSelected, "AddNew", new { Checked = "checked", @id = "rd_New" }) <label for="rd_New">Add New Items</label><br />
            @Html.RadioButtonFor(model => model.NewOrExistSetSelected, "UpdateExisting", new { @id = "rd_Exist" }) <label for="rd_Exist">Update Existing Items</label><br />
        </div>

        <div class="input-group mb-1">
            <div class="custom-file">
                <input accept=".xlsx" type="file" class="custom-file-input" id="inputGroupFile">
                <label class="custom-file-label" id="inputFileName" for="inputGroupFile"></label>
            </div>
            <div class="input-group-append">
                <span class="input-group-text btn-primary" id="uploadFile" onclick="uploadFile()">Upload</span>
            </div>
        </div>

        <p class="text-muted fine-print">*Only the Excel .xlsx file format is currently supported.</p>

        <div class="clearfix my-3">
            <div class="float-left">
                @Html.Label("Number of rows to display:")
                @Html.DropDownList("gridRowCount", new List<SelectListItem>()
                    {
                        new SelectListItem() { Value = "25", Text = "25" },
                        new SelectListItem() { Value = "50", Text = "50" },
                        new SelectListItem() { Value = "100", Text = "100", Selected = true},
                        new SelectListItem() { Value = "500", Text = "500" }
                    }, new { @class = "form-control" })
            </div>

            <div class="float-right">
                @Html.Label("Refresh Interval (in seconds):")
                @Html.DropDownList("refreshInterval", new List<SelectListItem>()
                  {   new SelectListItem() { Value = "5", Text = "5", Selected = true},
                      new SelectListItem() { Value = "10", Text = "10"},
                      new SelectListItem() { Value = "30", Text = "30" },
                      new SelectListItem() { Value = "60", Text = "60" },
                      new SelectListItem() { Value = "300", Text = "300" }
                  }, new { @class = "form-control" })
            </div>
            @*<table id="bulkUploadStatusGrid" />*@
        </div>

        <div>
            <label class="text-muted">File upload history</label>
            <table id="bulkUploadStatusGrid" style="height:25px;" />
        </div>

    </div>
}

<div id="dlgConfirm" title="User Confirmation Required" style="display:none;">
    <div style="max-height:500px; box-sizing:border-box;">
        <p id="dlgInfo">File: <span id="fileName"></span></p>
        <p id="dlgMsg" />
        <ul id="ulList"></ul>
        <hr />
        <div id="finePrint">
            <span id="dlgFYI" class="fine-print text-info"/>
            <div id="progress" class="progress">
                <div id="prgBar" class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
            </div>
        </div>

    </div>
</div>

@Scripts.Render("~/Scripts/Item/bulkupload.js")
