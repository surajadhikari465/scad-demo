@model Icon.Web.Mvc.Models.EwicMappingDetailViewModel

@{
    ViewBag.Title = "Mapping Detail";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@{Html.RenderPartial("_HeaderPartial", String.Format("eWIC Mapping Detail for APL Scan Code {0}", Model.AplScanCode));}

<hr />

<div class="page-section">
    @using (Html.BeginForm("AddMapping", "Ewic", FormMethod.Post, new { @class = "begin-form" }))
    {
        @Html.HiddenFor(model => model.AplScanCode)
        
        <fieldset>
            <legend>Add New Mapping</legend>
            <div class="form-inline">
                <div class="form-group">
                    @Html.TextBoxFor(model => Model.NewMapping, null, new { @class = "form-control", @id = "newExclusion" })
                </div>
                <input type="submit" value="Add Mapping" class="btn btn-light inline-submit-button" id="addButton" />
                @Html.ValidationMessageFor(model => model.NewMapping, null, new { @class = "form-property-val" })
            </div>
        </fieldset>
    }

    @using (Html.BeginForm("RemoveMapping", "Ewic", FormMethod.Post, new { @class = "begin-form" }))
    {
        @Html.HiddenFor(model => model.AplScanCode)
        
        <fieldset>
            <legend>Remove Existing Mapping</legend>
            <div class="form-inline">
                <div class="form-group">
                    @Html.DropDownListFor(model => Model.RemovableMappedWfmScanCodesSelectedId, Model.RemovableMappedWfmScanCodes, "--Select Mapping--", new { @class = "form-control" })
                </div>
                <input type="submit" value="Remove Mapping" class="btn btn-light inline-submit-button" id="removeButton" />
                @Html.ValidationMessageFor(model => model.RemovableMappedWfmScanCodesSelectedId, null, new { @class = "form-property-val" })
            </div>
        </fieldset>
    }
</div>

<div class="validation-section page-subsection" id="alert">
    @if (ViewData["SuccessMessage"] != null)
    {
        <div class="alert alert-success alert-dismissable">
            <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
            <strong>@ViewData["SuccessMessage"].ToString()</strong>
        </div>
    }
    @if (ViewData["ErrorMessage"] != null)
    {
        <div class="alert alert-danger alert-dismissable">
            <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
            <strong>@ViewData["ErrorMessage"].ToString()</strong>
        </div>
    }
</div>

@if (Model.CurrentMappings.Count > 0)
{
    <hr />
    <div class="page-section">
        <h4>Current Mappings</h4>
    </div>

    <div class="page-subsection">
        <table class="table table-striped table-bordered">
            <thead>
                <tr>
                    <th>Scan Code</th>
                    <th>Product Description</th>
                </tr>
            </thead>
            @foreach (var mapping in Model.CurrentMappings)
            {
                <tbody>
                    <tr>
                        <td>@mapping.ScanCode</td>
                        <td>@mapping.ProductDescription</td>
                    </tr>
                </tbody>
            }
        </table>
    </div>

    <hr />
    <div class="page-subsection">
        @Html.ActionLink("Select Another APL Scan Code", "Mappings")
    </div>
}
else
{
    <hr />
    <div class="page-section">
        <h4>No WFM scan codes are currently mapped to this APL scan code.</h4>
        @Html.ActionLink("Select Another APL Scan Code", "Mappings")
    </div>
}

@section scripts
{
    @Scripts.Render("~/Scripts/Ewic/mapping-detail.js")
    @Scripts.Render("~/Scripts/jquery-disable.js")
    @Scripts.Render("~/Scripts/Common/display-alert.js")
}
