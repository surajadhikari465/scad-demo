@using Icon.Web.Mvc.Utility

@{
    ViewBag.Title = "Bulk Upload";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div id="divLink">
    <a href="#" class="dropdown-toggle" data-toggle="dropdown" style="margin-right: 10px">Export</a>
        <ul class="dropdown-menu bg-light">
            <li class="nav-item">@Html.ActionLink("All Contacts", "Export", "Contact", new { hierarchyClassId = 0 }, new { @class = "text-nowrap ml-3" })</li>
        </ul>

    @if (ViewHelpers.HasWriteAccess(Request, User))
    {
        @Html.ActionLink("Download Contact Template", "ContactTemplateNewExporter", "Contact", null, new { @class = "text-nowrap ml-3" })
    }
</div>

@using (Html.BeginForm("BulkUpload", "Contact", null, FormMethod.Post, new { enctype = "multipart/form-data", @class = "begin-form" }))
{
    @Html.AntiForgeryToken()
    @Html.ValidationSummary(true)

    <div class="container col-10">
        <div class="text-center py-3">
            <h2>Contact Management</h2>
            <p class="lead">Bulk Upload</p>
        </div>
    
        <div class="input-group mb-1">
            <div class="custom-file">
                <input accept=".xlsx" type="file" class="custom-file-input" id="inputGroupFile">
                <label class="custom-file-label" id="inputFileName" for="inputGroupFile"></label>
            </div>
            <div class="input-group-append">
                <span class="input-group-text btn-primary" id="uploadFile" onclick="uploadFile()">Upload</span>
            </div>
        </div>
    
        <p class="text-muted fine-print">*Only the Excel .xlsx file format is currently supported.</p>
    
        <div>
            <label class="text-muted">File upload history</label>
            <table id="tblUpload" class="display stripe compact" style="width:100%;">
                <thead>
                    <tr>
                        <th>BulkContactUploadId</th>
                        <th>File Name</th>
                        <th>Uploaded By</th>
                        <th>Uploaded At</th>
                        <th></th>
                    </tr>
                </thead>
            </table>
        </div>
        <br />
    </div>
}


<div id="dlgConfirm" title="User Confirmation Required" style="display:none;">
    <div style="max-height:500px; box-sizing:border-box;">
        <p id="dlgInfo">File: <span id="fileName"></span></p>
        <p id="dlgMsg"/>
        <ul id="ulList"></ul>
        <hr />
        <div id="finePrint">
            <span id="dlgFYI" class="fine-print text-info">File will be processed after validation is completed.</span>
            <div id="progress" class="progress">
                <div id="prgBar" class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
            </div>
            <a id="dlgLink" href='/Contact/DownloadRefFile'>Download Reference File</a>
        </div>

    </div>
</div>

<div class="dropdown-menu" aria-labelledby="dropdownMenuButton" id="context-menu">
    <a class="dropdown-item fa fa-download" href="#" id="mnuDownload">&nbsp;&nbsp;&nbsp;Download</a>
    @*<div class="dropdown-divider"></div>
    <a class="dropdown-item fa fa-edit" href="#" id="mnuRename">&nbsp;&nbsp;&nbsp;Rename</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item text-danger fa fa-eraser" href="#" id="mnuDelete">&nbsp;&nbsp;&nbsp;Delete</a>*@
    <div class="dropdown-divider"></div>
    <a class="dropdown-item fa fa-close text-secondary" href="#" id="mnuCancel">&nbsp;&nbsp;&nbsp;Cancel</a>
</div>


@Scripts.Render("~/Scripts/Contact/bulkupload.js")
<link rel="stylesheet" type="text/css" href="~/Content/datatables.css" />
