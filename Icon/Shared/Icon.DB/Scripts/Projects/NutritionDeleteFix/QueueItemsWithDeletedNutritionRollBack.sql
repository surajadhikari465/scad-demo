ALTER VIEW [nutrition].[v4r_ItemNutrition]
AS
SELECT [RecipeId]
	,[Plu]
	,[RecipeName]
	,[Allergens]
	,[Ingredients]
	,[ServingsPerPortion]
	,[ServingSizeDesc]
	,[ServingPerContainer]
	,[HshRating]
	,[ServingUnits]
	,[SizeWeight]
	,[Calories]
	,[CaloriesFat]
	,[CaloriesSaturatedFat]
	,[TotalFatWeight]
	,[TotalFatPercentage]
	,[SaturatedFatWeight]
	,[SaturatedFatPercent]
	,[PolyunsaturatedFat]
	,[MonounsaturatedFat]
	,[CholesterolWeight]
	,[CholesterolPercent]
	,[SodiumWeight]
	,[SodiumPercent]
	,[PotassiumWeight]
	,[PotassiumPercent]
	,[TotalCarbohydrateWeight]
	,[TotalCarbohydratePercent]
	,[DietaryFiberWeight]
	,[DietaryFiberPercent]
	,[SolubleFiber]
	,[InsolubleFiber]
	,[Sugar]
	,[SugarAlcohol]
	,[OtherCarbohydrates]
	,[ProteinWeight]
	,[ProteinPercent]
	,[VitaminA]
	,[Betacarotene]
	,[VitaminC]
	,[Calcium]
	,[Iron]
	,[VitaminD]
	,[VitaminE]
	,[Thiamin]
	,[Riboflavin]
	,[Niacin]
	,[VitaminB6]
	,[Folate]
	,[VitaminB12]
	,[Biotin]
	,[PantothenicAcid]
	,[Phosphorous]
	,[Iodine]
	,[Magnesium]
	,[Zinc]
	,[Copper]
	,[Transfat]
	,[CaloriesFromTransfat]
	,[Om6Fatty]
	,[Om3Fatty]
	,[Starch]
	,[Chloride]
	,[Chromium]
	,[VitaminK]
	,[Manganese]
	,[Molybdenum]
	,[Selenium]
	,[TransfatWeight]
	,[InsertDate]
	,[ModifiedDate]
	,[AddedSugarsWeight]
	,[AddedSugarsPercent]
	,[CalciumWeight]
	,[IronWeight]
	,[VitaminDWeight]
FROM [nutrition].[ItemNutrition]
GO

-- set system versioning off
IF (
		SELECT temporal_type
		FROM sys.tables
		WHERE name = 'ItemNutrition'
			AND SCHEMA_NAME(schema_id) = 'nutrition'
		) <> 0
BEGIN
	PRINT 'Disabling [nutrition] history'

	ALTER TABLE [nutrition].[ItemNutrition]

	SET (SYSTEM_VERSIONING = OFF)
END

GO
ALTER TABLE [nutrition].[ItemNutrition]

DROP PERIOD
FOR SYSTEM_TIME;
GO

DELETE nutrition.[ItemNutritionHistory]
WHERE plu IN (
		'46000001785'
		,'46000057597'
		,'46000057459'
		,'24205500000'
		,'46000059391'
		,'46000057157'
		,'27055800000'
		,'27056100000'
		,'27008700000'
		,'26654700000'
		,'26846200000'
		,'10308'
		,'26861900000'
		,'22135900000'
		,'24055600000'
		,'24877300000'
		,'24942100000'
		,'22036200000'
		,'24249100000'
		,'28563700000'
		,'22236400000'
		,'46000054721'
		,'23099700000'
		,'26318300000'
		,'24871300000'
		,'26318500000'
		,'27111700000'
		,'26477600000'
		,'24872600000'
		,'24871500000'
		,'27741000000'
		,'24988500000'
		,'24205300000'
		,'28624300000'
		,'46000058751'
		,'27563900000'
		,'24205700000'
		,'24186900000'
		,'23408800000'
		,'22164100000'
		,'26788100000'
		,'23170000000'
		,'24150400000'
		,'20685800000'
		,'26986100000'
		,'24842900000'
		,'26689900000'
		,'26739200000'
		,'24361700000'
		,'24114200000'
		,'23213600000'
		,'23256500000'
		,'23276800000'
		,'23287800000'
		,'46000062598'
		,'28871300000'
		,'28883700000'
		,'28889500000'
		,'28923000000'
		,'28921100000'
		,'23753200000'
		,'26080200000'
		,'46000063034'
		,'28945100000'
		,'23342200000'
		,'27758800000'
		,'28992100000'
		,'500155'
		,'46000063768'
		,'46000063769'
		,'46000063839'
		,'100167'
		,'481531'
		,'100169'
		,'499472'
		,'100173'
		,'100165'
		,'100172'
		,'46000064420'
		,'46000003520'
		,'27858900000'
		,'27859000000'
		,'27858800000'
		,'46000004098'
		,'22370000000'
		,'22408700000'
		,'22408800000'
		,'22408400000'
		,'22408200000'
		,'46000006128'
		,'20246200000'
		,'20246000000'
		,'480670'
		,'22508600000'
		,'46000006370'
		,'22580900000'
		,'10861'
		,'22321200000'
		,'20490'
		,'22714200000'
		,'499477'
		,'46000008248'
		,'22871700000'
		,'22871900000'
		,'22902800000'
		,'22903700000'
		,'22967300000'
		,'22966000000'
		,'22965800000'
		,'23666900000'
		,'23677700000'
		,'46000012157'
		,'104370'
		,'23785800000'
		,'23805600000'
		,'23856400000'
		,'23934800000'
		,'46000013529'
		,'105427'
		,'23995600000'
		,'27878200000'
		,'500118'
		,'105761'
		,'105760'
		,'105757'
		,'105765'
		,'105764'
		,'105768'
		,'105758'
		,'105753'
		,'29336700000'
		,'105967'
		,'46000014229'
		,'27993300000'
		,'25259400000'
		,'23733900000'
		,'26019100000'
		,'26043000000'
		,'46000014930'
		,'26054400000'
		,'26054700000'
		,'26054900000'
		,'26056000000'
		,'26056100000'
		,'26056200000'
		,'26056700000'
		,'26057000000'
		,'26057100000'
		,'26057200000'
		,'26057400000'
		,'26057600000'
		,'26057700000'
		,'26057800000'
		,'26057900000'
		,'26058100000'
		,'26056400000'
		,'26056500000'
		,'22070200000'
		,'22133800000'
		,'26526300000'
		,'107016'
		,'107010'
		,'46000016736'
		,'46000016734'
		,'46000016733'
		,'28339900000'
		,'46000016943'
		,'107630'
		,'107633'
		,'107629'
		,'107628'
		,'28496000000'
		,'28496600000'
		,'28497000000'
		,'28599600000'
		,'28604000000'
		,'28534300000'
		,'28534800000'
		,'28534900000'
		,'28535200000'
		,'28535600000'
		,'28536000000'
		,'28761700000'
		,'28757800000'
		,'28758300000'
		,'28757400000'
		,'28753500000'
		,'28779400000'
		,'28776000000'
		,'28771000000'
		,'28768100000'
		,'28768200000'
		,'28765200000'
		,'28768000000'
		,'28764600000'
		,'26127200000'
		,'26129000000'
		,'26124200000'
		,'26122300000'
		,'26129100000'
		,'26126700000'
		,'26130100000'
		,'26130200000'
		,'26136100000'
		,'26136600000'
		,'26136700000'
		,'26136800000'
		,'26137000000'
		,'26137100000'
		,'26137200000'
		,'26137300000'
		,'26137900000'
		,'26138300000'
		,'26138500000'
		,'26154200000'
		,'26154600000'
		,'26155100000'
		,'26155200000'
		,'26155400000'
		,'26155800000'
		,'26156000000'
		,'26156100000'
		,'26156200000'
		,'26156300000'
		,'26156400000'
		,'46000017319'
		,'26168900000'
		,'26169500000'
		,'26171100000'
		,'26171300000'
		,'26171500000'
		,'26175600000'
		,'26175700000'
		,'26176200000'
		,'26176300000'
		,'26176500000'
		,'26176700000'
		,'26176900000'
		,'26177000000'
		,'26177200000'
		,'26177600000'
		,'26177700000'
		,'26177800000'
		,'46000017655'
		,'26183700000'
		,'26183900000'
		,'26191700000'
		,'26192100000'
		,'26207900000'
		,'26208000000'
		,'26208100000'
		,'26208200000'
		,'26208400000'
		,'23052200000'
		,'23052300000'
		,'26246200000'
		,'46000018413'
		,'26318600000'
		,'23088700000'
		,'67207'
		,'23198600000'
		,'26438100000'
		,'26439000000'
		,'109022'
		,'26495600000'
		,'46000020153'
		,'26678500000'
		,'26675300000'
		,'26672900000'
		,'46000020297'
		,'26695400000'
		,'26713800000'
		,'23333800000'
		,'23334000000'
		,'23338500000'
		,'10290'
		,'24792300000'
		,'26891700000'
		,'26899200000'
		,'46000023936'
		,'27351100000'
		,'46000024607'
		,'27603800000'
		,'46000025777'
		,'111185'
		,'28908200000'
		,'28908300000'
		,'23005300000'
		,'26221500000'
		,'24238500000'
		,'24250800000'
		,'24251100000'
		,'24251200000'
		,'112476'
		,'112477'
		,'112478'
		,'112479'
		,'112480'
		,'24305400000'
		,'24305500000'
		,'24306300000'
		,'24306500000'
		,'24306800000'
		,'24307800000'
		,'24308100000'
		,'24308900000'
		,'24309600000'
		,'24341300000'
		,'24341600000'
		,'24342100000'
		,'24342900000'
		,'24343100000'
		,'24343200000'
		,'406768'
		,'24410200000'
		,'24411000000'
		,'24411600000'
		,'24411900000'
		,'24412600000'
		,'24413000000'
		,'24414800000'
		,'24415600000'
		,'24415800000'
		,'24417100000'
		,'24417800000'
		,'24418100000'
		,'24418800000'
		,'24419200000'
		,'24419600000'
		,'24419900000'
		,'24420300000'
		,'24420900000'
		,'24421000000'
		,'24421100000'
		,'24421400000'
		,'24421700000'
		,'407123'
		,'407124'
		,'407126'
		,'407127'
		,'407130'
		,'407131'
		,'22616000000'
		,'24861100000'
		,'24666800000'
		,'22617600000'
		,'24497200000'
		,'25574000000'
		,'25569700000'
		,'25575100000'
		,'25575700000'
		,'25575900000'
		,'25575600000'
		,'25574200000'
		,'25573500000'
		,'25573000000'
		,'25571300000'
		,'29943600000'
		,'25906100000'
		,'25909100000'
		,'25909300000'
		,'25910500000'
		,'25910900000'
		,'25912100000'
		,'25912300000'
		,'25912500000'
		,'25916200000'
		,'25917500000'
		,'25920500000'
		,'26131100000'
		,'26130700000'
		,'26127300000'
		,'26126200000'
		,'26146500000'
		,'26146800000'
		,'26148100000'
		,'26152800000'
		,'26154400000'
		,'26154900000'
		,'26157800000'
		,'26158400000'
		,'26163500000'
		,'26164800000'
		,'26170300000'
		,'26171400000'
		,'26173800000'
		,'26174500000'
		,'26176800000'
		,'26279200000'
		,'26279400000'
		,'26279600000'
		,'26255200000'
		,'26279800000'
		)
GO
ALTER VIEW [nutrition].[v4r_ItemNutrition]
	WITH SCHEMABINDING
AS
SELECT [RecipeId]
	,[Plu]
	,[RecipeName]
	,[Allergens]
	,[Ingredients]
	,[ServingsPerPortion]
	,[ServingSizeDesc]
	,[ServingPerContainer]
	,[HshRating]
	,[ServingUnits]
	,[SizeWeight]
	,[Calories]
	,[CaloriesFat]
	,[CaloriesSaturatedFat]
	,[TotalFatWeight]
	,[TotalFatPercentage]
	,[SaturatedFatWeight]
	,[SaturatedFatPercent]
	,[PolyunsaturatedFat]
	,[MonounsaturatedFat]
	,[CholesterolWeight]
	,[CholesterolPercent]
	,[SodiumWeight]
	,[SodiumPercent]
	,[PotassiumWeight]
	,[PotassiumPercent]
	,[TotalCarbohydrateWeight]
	,[TotalCarbohydratePercent]
	,[DietaryFiberWeight]
	,[DietaryFiberPercent]
	,[SolubleFiber]
	,[InsolubleFiber]
	,[Sugar]
	,[SugarAlcohol]
	,[OtherCarbohydrates]
	,[ProteinWeight]
	,[ProteinPercent]
	,[VitaminA]
	,[Betacarotene]
	,[VitaminC]
	,[Calcium]
	,[Iron]
	,[VitaminD]
	,[VitaminE]
	,[Thiamin]
	,[Riboflavin]
	,[Niacin]
	,[VitaminB6]
	,[Folate]
	,[VitaminB12]
	,[Biotin]
	,[PantothenicAcid]
	,[Phosphorous]
	,[Iodine]
	,[Magnesium]
	,[Zinc]
	,[Copper]
	,[Transfat]
	,[CaloriesFromTransfat]
	,[Om6Fatty]
	,[Om3Fatty]
	,[Starch]
	,[Chloride]
	,[Chromium]
	,[VitaminK]
	,[Manganese]
	,[Molybdenum]
	,[Selenium]
	,[TransfatWeight]
	,[InsertDate]
	,[ModifiedDate]
	,[AddedSugarsWeight]
	,[AddedSugarsPercent]
	,[CalciumWeight]
	,[IronWeight]
	,[VitaminDWeight]
FROM [nutrition].[ItemNutrition]
GO

ALTER TABLE [nutrition].[ItemNutrition] ADD PERIOD
FOR SYSTEM_TIME(SysStartTimeUtc, SysEndTimeUtc)

ALTER TABLE [nutrition].[ItemNutrition]

SET (SYSTEM_VERSIONING = ON (HISTORY_TABLE = [nutrition].[ItemNutritionHistory]));