<?xml version="1.0" encoding="utf-8" ?>
<configuration>
<!--****************************************************************
 Config File: VIM_Item_Master.cfg
      Author: Min Zhao, trey d'amico
        Date: 01/27/2014

 Description: 
 This job extracts the Item Master info from the VIM.
 Here
 
 Modification History: 
 Date       Init Comment
 01/27/2014 MZ   Created.
 02/21/2014 td	  went from db-to-file to db-to-db
					  to save time due to logging, use this commandline:

					  E:\Program Files (x86)\DataMonkey 2>datamonkey.exe conf/VIM_Item_iCon_Load.cfg Y 1 Y	
 02/21/2014      Done - [1048300] records transferred. Start: [02/22/2014 13:01:45] Stop: [02/22/2014 14:19:51] Elapsed: [78.100] minutes.
******************************************************************-->

<!--********************************************************************
 Global Key Definitions
********************************************************************-->
   <config key="sqlTimeout"      value="1800"/>
   <config key="emailSMTPServer" value="smtp.wholefoods.com"/>
   <config key="LogFile"         value="logs/VIMItemIConLoad_{yyyy}{mm}{dd}.log"/>
   <config key="ParameterFile"   value="conf/VIM_Item_iCon_Load.prm"/>
   <config key="MaxEntries"      value="5"/>
   
   <!-- Database ODBC Connection string keys -->

   <config key="VIM"             value="ORACLE,Data Source=VIMPRD;User Id=vim_user_icon;Password=v1mus3r1c0n;"/>
   <config key="ICONDEV"         value="FILE:conn/iCon_Connection.txt"/>
 
<!--********************************************************************
 Delimiter Configurations
********************************************************************-->
   <config key="pipe"           value="|"/>
	
<!--********************************************************************
 Source / Target Entries
********************************************************************-->
   <config key="source_1"     value="DB, VIM, QUERY, item_master_qry, pipe, , "/>
   <config key="target_1"     value="DB, ICONDEV, REPLACE, VIMData, pipe, maketable, "/>

   <config key="item_master_qry"  value="
		select ltrim(to_char(im.nat_upc), '0'), im.long_description, im.pos_description,im.item_uom, b.brand_name, TO_CHAR(SYSDATE, 'DD-MON-YYYY HH:MI:SS') 
		  from VIM.item_master im 
     left join VIM.brand b on im.brand = b.brand  
   "/>
	
	<config key="maketable"     value="DB, ICONDEV, QUERY, make_table, "/>

	<config key="make_table"    value="
IF EXISTS ( SELECT
               *
            FROM   INFORMATION_SCHEMA.tables
            WHERE  table_name = 'VIMData' )
   DROP TABLE vimdata; 

CREATE TABLE [dbo].[VIMData](
	[ScanCode] [varchar](13) NULL,
	[ProductDescription] [varchar](60) NULL,
	[POSDescription] [varchar](40) NULL,
	[PackageUnit] [varchar](5) NULL,
	[Brand] [varchar](50) NULL,
	[InsertDate] [datetime] NOT NULL
) ON [PRIMARY]
	"/>

</configuration>