<?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2008/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Body>
    <ReportItems>
      <Tablix Name="table1">
        <TablixBody>
          <TablixColumns>
            <TablixColumn>
              <Width>1.25in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>6.875in</Width>
            </TablixColumn>
          </TablixColumns>
          <TablixRows>
            <TablixRow>
              <Height>0.25in</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="textbox22">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>Identifier</Value>
                              <Style>
                                <FontFamily>Tahoma</FontFamily>
                                <FontSize>8pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                                <Color>White</Color>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <ZIndex>6</ZIndex>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>SteelBlue</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="textbox5">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>Description</Value>
                              <Style>
                                <FontFamily>Tahoma</FontFamily>
                                <FontSize>8pt</FontSize>
                                <FontWeight>Bold</FontWeight>
                                <Color>White</Color>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>textbox5</rd:DefaultName>
                      <ZIndex>5</ZIndex>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>SteelBlue</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
              </TablixCells>
            </TablixRow>
            <TablixRow>
              <Height>0.25in</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="textbox2">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!identifier.Value</Value>
                              <Style>
                                <FontFamily>Tahoma</FontFamily>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <ZIndex>4</ZIndex>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                        </Border>
                        <TopBorder>
                          <Style>Solid</Style>
                        </TopBorder>
                        <BottomBorder>
                          <Style>None</Style>
                        </BottomBorder>
                        <LeftBorder>
                          <Style>Solid</Style>
                        </LeftBorder>
                        <RightBorder>
                          <Style>None</Style>
                        </RightBorder>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="textbox1">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!itemdescription.Value</Value>
                              <Style>
                                <FontFamily>Tahoma</FontFamily>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>textbox1</rd:DefaultName>
                      <ZIndex>3</ZIndex>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                        </Border>
                        <TopBorder>
                          <Style>Solid</Style>
                        </TopBorder>
                        <BottomBorder>
                          <Style>None</Style>
                        </BottomBorder>
                        <LeftBorder>
                          <Style>None</Style>
                        </LeftBorder>
                        <RightBorder>
                          <Style>Solid</Style>
                        </RightBorder>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
              </TablixCells>
            </TablixRow>
            <TablixRow>
              <Height>0.25in</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="textbox4">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>="     " &amp; RowNumber("MainDataGroup") &amp; ": " &amp; Fields!error.Value</Value>
                              <Style>
                                <FontFamily>Tahoma</FontFamily>
                                <FontSize>8pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>textbox4</rd:DefaultName>
                      <Style>
                        <TopBorder>
                          <Style>None</Style>
                        </TopBorder>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                    <ColSpan>2</ColSpan>
                  </CellContents>
                </TablixCell>
                <TablixCell />
              </TablixCells>
            </TablixRow>
            <TablixRow>
              <Height>0.1in</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="textbox15">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>textbox15</rd:DefaultName>
                      <ZIndex>2</ZIndex>
                      <Style>
                        <BackgroundColor>DimGray</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="textbox16">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value />
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>textbox16</rd:DefaultName>
                      <ZIndex>1</ZIndex>
                      <Style>
                        <BackgroundColor>DimGray</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
              </TablixCells>
            </TablixRow>
          </TablixRows>
        </TablixBody>
        <TablixColumnHierarchy>
          <TablixMembers>
            <TablixMember />
            <TablixMember />
          </TablixMembers>
        </TablixColumnHierarchy>
        <TablixRowHierarchy>
          <TablixMembers>
            <TablixMember>
              <KeepWithGroup>After</KeepWithGroup>
              <KeepTogether>true</KeepTogether>
            </TablixMember>
            <TablixMember>
              <Group Name="MainDataGroup">
                <GroupExpressions>
                  <GroupExpression>=Fields!identifier.Value</GroupExpression>
                </GroupExpressions>
              </Group>
              <TablixMembers>
                <TablixMember>
                  <KeepWithGroup>After</KeepWithGroup>
                  <KeepTogether>true</KeepTogether>
                </TablixMember>
                <TablixMember>
                  <Group Name="table1_Group2">
                    <GroupExpressions>
                      <GroupExpression>=Fields!identifier.Value</GroupExpression>
                    </GroupExpressions>
                  </Group>
                  <TablixMembers>
                    <TablixMember>
                      <Group Name="table1_Details_Group">
                        <DataElementName>Detail</DataElementName>
                      </Group>
                      <TablixMembers>
                        <TablixMember />
                      </TablixMembers>
                      <DataElementName>Detail_Collection</DataElementName>
                      <DataElementOutput>Output</DataElementOutput>
                      <KeepTogether>true</KeepTogether>
                    </TablixMember>
                    <TablixMember>
                      <KeepWithGroup>Before</KeepWithGroup>
                      <KeepTogether>true</KeepTogether>
                    </TablixMember>
                  </TablixMembers>
                </TablixMember>
              </TablixMembers>
            </TablixMember>
          </TablixMembers>
        </TablixRowHierarchy>
        <DataSetName>EXEChecklist</DataSetName>
        <Height>0.85in</Height>
        <Width>8.125in</Width>
        <Style>
          <Border>
            <Style>Solid</Style>
          </Border>
        </Style>
      </Tablix>
    </ReportItems>
    <Height>0.85in</Height>
    <Style />
  </Body>
  <Width>8.25in</Width>
  <Page>
    <PageHeader>
      <Height>0.625in</Height>
      <PrintOnFirstPage>true</PrintOnFirstPage>
      <PrintOnLastPage>true</PrintOnLastPage>
      <ReportItems>
        <Textbox Name="rptPrintDate">
          <CanGrow>true</CanGrow>
          <KeepTogether>true</KeepTogether>
          <Paragraphs>
            <Paragraph>
              <TextRuns>
                <TextRun>
                  <Value>="Report Run: " &amp; FormatDateTime(Now)</Value>
                  <Style>
                    <FontFamily>Tahoma</FontFamily>
                  </Style>
                </TextRun>
              </TextRuns>
              <Style>
                <TextAlign>Center</TextAlign>
              </Style>
            </Paragraph>
          </Paragraphs>
          <Top>0.125in</Top>
          <Height>0.25in</Height>
          <Width>2in</Width>
          <Style>
            <PaddingLeft>2pt</PaddingLeft>
            <PaddingRight>2pt</PaddingRight>
            <PaddingTop>2pt</PaddingTop>
            <PaddingBottom>2pt</PaddingBottom>
          </Style>
        </Textbox>
        <Textbox Name="rptPageNumber">
          <CanGrow>true</CanGrow>
          <KeepTogether>true</KeepTogether>
          <Paragraphs>
            <Paragraph>
              <TextRuns>
                <TextRun>
                  <Value>="Page " &amp; Globals!PageNumber &amp; " of " &amp; Globals!TotalPages</Value>
                  <Style>
                    <FontFamily>Tahoa</FontFamily>
                  </Style>
                </TextRun>
              </TextRuns>
              <Style>
                <TextAlign>Right</TextAlign>
              </Style>
            </Paragraph>
          </Paragraphs>
          <Top>0.125in</Top>
          <Left>6.75in</Left>
          <Height>0.25in</Height>
          <Width>1.25in</Width>
          <ZIndex>1</ZIndex>
          <Style>
            <PaddingLeft>2pt</PaddingLeft>
            <PaddingRight>2pt</PaddingRight>
            <PaddingTop>2pt</PaddingTop>
            <PaddingBottom>2pt</PaddingBottom>
          </Style>
        </Textbox>
        <Textbox Name="textbox3">
          <CanGrow>true</CanGrow>
          <KeepTogether>true</KeepTogether>
          <Paragraphs>
            <Paragraph>
              <TextRuns>
                <TextRun>
                  <Value>EXE Checklist</Value>
                  <Style>
                    <FontFamily>Tahoma</FontFamily>
                    <FontSize>20pt</FontSize>
                    <FontWeight>Bold</FontWeight>
                    <Color>SteelBlue</Color>
                  </Style>
                </TextRun>
              </TextRuns>
              <Style>
                <TextAlign>Center</TextAlign>
              </Style>
            </Paragraph>
          </Paragraphs>
          <Left>2.375in</Left>
          <Height>0.5in</Height>
          <Width>4in</Width>
          <ZIndex>2</ZIndex>
          <Style>
            <PaddingLeft>2pt</PaddingLeft>
            <PaddingRight>2pt</PaddingRight>
            <PaddingTop>2pt</PaddingTop>
            <PaddingBottom>2pt</PaddingBottom>
          </Style>
        </Textbox>
      </ReportItems>
      <Style />
    </PageHeader>
    <PageHeight>8.5in</PageHeight>
    <PageWidth>14in</PageWidth>
    <InteractiveHeight>11in</InteractiveHeight>
    <InteractiveWidth>8.5in</InteractiveWidth>
    <LeftMargin>0.25in</LeftMargin>
    <RightMargin>0.25in</RightMargin>
    <TopMargin>0.25in</TopMargin>
    <BottomMargin>0.25in</BottomMargin>
    <Style />
  </Page>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="ItemCatalog">
      <DataSourceReference>ItemCatalog</DataSourceReference>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>5ba21e16-d2b6-473e-b9d6-0a1162e8471c</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="EXEChecklist">
      <Query>
        <DataSourceName>ItemCatalog</DataSourceName>
        <QueryParameters>
          <QueryParameter Name="@SubTeam_No">
            <Value>=Parameters!SubTeam_No.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@DC_Store_No">
            <Value>=Parameters!DC_Store_No.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@DC_Vendor_Id">
            <Value>=Parameters!DC_Vendor_Id.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@Store_No">
            <Value>=Parameters!Store_No.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <CommandText>DECLARE @EXECheckList TABLE
		(
			Item_Key int,
			Error varchar(500)
		)

		--All default identifiers on EXEDistributed items must be type SKU
		INSERT INTO @EXECheckList
			SELECT DISTINCT I.Item_Key, 'EXEDistributed item does not have a default identifier of type SKU'
			FROM ItemIdentifier II
			JOIN ITEM I on I.Item_Key = II.Item_Key
			WHERE I.EXEDistributed = 1 AND I.SubTeam_No = @SubTeam_No AND II.Default_Identifier = 1 AND II.Deleted_Identifier = 0 AND ISNULL(II.IdentifierType,'L') &lt;&gt; 'S'

		--Has Distribution Subteam and EXEDistribution is False
		INSERT INTO @EXECheckList
			SELECT I.Item_Key, 'Distribution SubTeam is set but EXEDistributed is False'
			FROM Item I
			JOIN ItemIdentifier II ON  II.Item_Key = I.Item_Key
			WHERE EXEDistributed = 0 AND I.SubTeam_No = @SubTeam_No AND I.DistSubTeam_No IS NOT NULL AND II.Default_Identifier = 1 AND Deleted_Identifier = 0

		--Does Distribution SubTeam = SubTeam
		INSERT INTO @EXECheckList
			SELECT I.Item_Key, 'Distribution SubTeam is not equal to the SubTeam'
			FROM Item I
			JOIN ItemIdentifier II ON  II.Item_Key = I.Item_Key
			WHERE I.EXEDistributed = 1 AND I.DistSubTeam_No &lt;&gt; I.SubTeam_No AND I.SubTeam_No = @SubTeam_No AND II.Default_Identifier = 1 AND II.Deleted_Identifier = 0

		--DC has a Primary Vendor assigned
		INSERT INTO @EXECheckList
			SELECT DISTINCT I.Item_Key, 'The DC does not have a primary vendor set'
			FROM ItemIdentifier II
			JOIN StoreItemVendor SIV ON SIV.Item_Key = II.Item_Key 
			JOIN ITEM I on I.Item_Key = II.Item_Key
			WHERE SIV.Store_No = @DC_Store_No AND I.EXEDistributed = 1 AND I.SubTeam_No = @SubTeam_No AND II.Default_Identifier = 1 AND II.Deleted_Identifier = 0
				  AND NOT EXISTS (
	  							  SELECT SIV2.Item_Key 
								  FROM StoreItemVendor SIV2 WHERE SIV2.Item_Key = II.Item_Key AND SIV2.Store_No = @DC_Store_No AND PrimaryVendor = 1
								  )

		--Stores have DC as Primary Vendor
		INSERT INTO @EXECheckList
			SELECT DISTINCT I.Item_Key, 'The stores do not have the DC as the primary vendor'
			FROM ItemIdentifier II
			JOIN StoreItemVendor SIV ON SIV.Item_Key = II.Item_Key 
			JOIN ITEM I on I.Item_Key = II.Item_Key
			WHERE SIV.Vendor_Id = @DC_Vendor_Id AND I.EXEDistributed = 1 AND I.SubTeam_No = @SubTeam_No AND II.Default_Identifier = 1 AND II.Deleted_Identifier = 0
				  AND NOT EXISTS (
	  							  SELECT siv2.Item_Key 
								  FROM StoreItemVendor SIV2 
								  WHERE SIV2.Item_Key = II.Item_Key AND SIV2.vendor_id = @DC_Vendor_Id AND PrimaryVendor = 1 
								  GROUP BY SIV2.Item_Key
								  HAVING COUNT(store_no) = (SELECT COUNT(*) FROM Store WHERE WFM_Store = 1)
								  )

		--Cost exists between DC and Primary Vendor
		INSERT INTO @EXECheckList
			SELECT DISTINCT I.Item_Key, 'The cost between the DC and the primary external vendor is missing'
			FROM Item I
			JOIN ItemIdentifier II ON  II.Item_Key = I.Item_Key
			JOIN storeitemvendor siv2 on siv2.Item_Key = I.Item_Key
			WHERE NOT EXISTS(SELECT * FROM VendorCostHistory WHERE StoreItemVendorId IN (
																						SELECT siv.StoreItemVendorId
																						FROM StoreItemVendor siv
																						WHERE SIV.Item_Key = I.Item_Key AND SIV.Store_No = @DC_Store_No AND SIV.PrimaryVendor = 1))
			AND I.EXEDistributed = 1 AND I.SubTeam_No = @SubTeam_No AND II.Default_Identifier = 1 AND SIV2.Store_No = @DC_Store_No AND SIV2.PrimaryVendor = 1 AND II.Deleted_Identifier = 0

		--Cost exists between DC and Stores
		INSERT INTO @EXECheckList
			SELECT DISTINCT I.Item_Key, 'The cost between the stores and the DC is missing'
			FROM Item I
			JOIN ItemIdentifier II ON  II.Item_Key = I.Item_Key
			JOIN storeitemvendor siv2 on siv2.Item_Key = I.Item_Key
			WHERE NOT EXISTS(SELECT * FROM VendorCostHistory WHERE StoreItemVendorId IN (
																						SELECT DISTINCT SIV.StoreItemVendorId
																						FROM Item I
																						JOIN ItemIdentifier II ON  II.Item_Key = I.Item_Key
																						JOIN storeitemvendor siv on siv.Item_Key = I.Item_Key
																						WHERE I.EXEDistributed = 1 AND I.SubTeam_No = @SubTeam_No AND II.Default_Identifier = 1 AND SIV.Store_No = 801 
																						AND SIV.Vendor_Id = @DC_Vendor_Id AND I.Item_Key = SIV2.Item_Key))
			AND I.EXEDistributed = 1 AND I.SubTeam_No = @SubTeam_No AND II.Default_Identifier = 1 AND SIV2.Vendor_Id = @DC_Vendor_Id AND II.Deleted_Identifier = 0


		--Cost Unit on Cost screen must match the Vendor Cost Unit on the Item Screen for DC to External Vendor
		INSERT INTO @EXECheckList
			SELECT I.Item_Key, 'The cost unit on the Cost screen does not match the Vendor Cost Unit on the item screen for the DC to external vendor'
			FROM Item I
			JOIN ItemIdentifier II ON  II.Item_Key = I.Item_Key
			JOIN StoreItemVendor SIV2 ON SIV2.Item_Key = I.Item_Key
			JOIN VendorCostHistory VCH ON VCH.StoreItemVendorId = SIV2.StoreItemVendorId
			JOIN ItemUnit IU1 ON IU1.Unit_Id = VCH.CostUnit_Id
			JOIN ItemUnit IU2 ON IU2.Unit_Id = I.Vendor_Unit_Id
			WHERE 
			I.EXEDistributed = 1 AND I.SubTeam_No = @SubTeam_No AND II.Default_Identifier = 1 AND SIV2.Store_No = @DC_Store_No AND SIV2.PrimaryVendor = 1 
			AND VCH.CostUnit_Id &lt;&gt; I.Vendor_Unit_Id AND II.Deleted_Identifier = 0 AND 
				VCH.VendorCostHistoryId = (
											SELECT TOP 1 VendorCostHistoryId
											FROM VendorCostHistory VCH (nolock)
											WHERE VCH.StoreItemVendorId = dbo.fn_GetStoreItemVendorId(I.Item_Key, @DC_Store_No) AND StartDate &lt;= GETDATE() AND EndDate &gt;= getdate()
											ORDER BY VendorCostHistoryID DESC
										  )

		--Cost Unit on Cost screen must match the Vendor Cost Unit on the Item Screen for the DC to the Stores
		INSERT INTO @EXECheckList
			SELECT I.Item_Key, 'The cost unit on the Cost screen does not match the Vendor Cost Unit on the item screen for the DC to the stores'
			FROM Item I
			JOIN ItemIdentifier II ON  II.Item_Key = I.Item_Key
			JOIN StoreItemVendor SIV2 ON SIV2.Item_Key = I.Item_Key
			JOIN VendorCostHistory VCH ON VCH.StoreItemVendorId = SIV2.StoreItemVendorId
			JOIN ItemUnit IU1 ON IU1.Unit_Id = VCH.CostUnit_Id
			JOIN ItemUnit IU2 ON IU2.Unit_Id = I.Vendor_Unit_Id
			WHERE 
			I.EXEDistributed = 1 AND I.SubTeam_No = @SubTeam_No AND II.Default_Identifier = 1 AND SIV2.Store_No = @Store_No AND SIV2.PrimaryVendor = 1 AND dbo.fn_GetDiscontinueStatus(I.Item_Key, NULL, NULL) = 0
			AND VCH.CostUnit_Id &lt;&gt; I.Vendor_Unit_Id AND
				VCH.VendorCostHistoryId = (
											SELECT TOP 1 VendorCostHistoryId
											FROM VendorCostHistory VCH (nolock)
											WHERE VCH.StoreItemVendorId = dbo.fn_GetStoreItemVendorId(I.Item_Key, @Store_No) AND StartDate &lt;= GETDATE() AND EndDate &gt;= getdate()
											ORDER BY VendorCostHistoryID DESC
										  )

		--If Retail Unit on Item Screen = POUNDS, Vendor Order Unit and Distribution Unit = BOX
		INSERT INTO @EXECheckList
			SELECT I.Item_Key, 'The Retail Unit on the item screen is POUNDS but the Vendor Order Unit and/or the Distribution Unit is not BOX'
			FROM Item I
			JOIN ItemIdentifier II ON  II.Item_Key = I.Item_Key
			JOIN ItemUnit IU1 on IU1.Unit_Id = I.Retail_Unit_Id 
			JOIN ItemUnit IU2 on IU2.Unit_Id = I.Vendor_Unit_Id
			JOIN ItemUnit IU3 on IU3.Unit_Id = I.Distribution_Unit_Id
			WHERE I.EXEDistributed = 1 AND I.DistSubTeam_No = @SubTeam_No  AND II.Default_Identifier = 1 AND II.Deleted_Identifier = 0 AND 
				  IU1.Unit_Name = 'POUNDS' AND (IU2.Unit_Name &lt;&gt; 'BOX' OR IU3.Unit_Name &lt;&gt; 'BOX')


		--If Retail Unit on Item Screen = EACH, Vendor Order Unit and Distribution Unit = CASE
		INSERT INTO @EXECheckList
			SELECT I.Item_Key, 'The Retail Unit on the item screen is EACH but the Vendor Order Unit and/or the Distribution Unit is not CASE'
			FROM Item I
			JOIN ItemIdentifier II ON  II.Item_Key = I.Item_Key
			JOIN ItemUnit IU1 ON IU1.Unit_Id = I.Retail_Unit_Id 
			JOIN ItemUnit IU2 ON IU2.Unit_Id = I.Vendor_Unit_Id
			JOIN ItemUnit IU3 ON IU3.Unit_Id = I.Distribution_Unit_Id
			WHERE I.EXEDistributed = 1 AND I.DistSubTeam_No = @SubTeam_No AND II.Default_Identifier = 1 AND II.Deleted_Identifier = 0 AND 
				  IU1.Unit_Name = 'EACH' AND (IU2.Unit_Name &lt;&gt; 'CASE' OR IU3.Unit_Name &lt;&gt; 'CASE')

		--All DC items must be authorized for the DC store (set to 0)
		INSERT INTO @EXECheckList
			SELECT I.Item_Key, 'This item is not authorized to the DC store'
			FROM Item I
			JOIN ItemIdentifier II ON  II.Item_Key = I.Item_Key
			JOIN StoreItem SI ON SI.Item_Key = I.Item_Key
			WHERE I.EXEDistributed = 1 AND I.DistSubTeam_No = @SubTeam_No AND II.Default_Identifier = 1 AND SI.Store_No = @DC_Store_No AND SI.Authorized = 0 AND II.Deleted_Identifier = 0

		--All DC items must be authorized for the DC store (missing)
		INSERT INTO @EXECheckList
			SELECT I.Item_Key, 'This item is missing authorization to the DC store'
			FROM Item I
			JOIN ItemIdentifier II ON  II.Item_Key = I.Item_Key
			JOIN StoreItem SI ON SI.Item_Key = I.Item_Key
			WHERE I.EXEDistributed = 1 AND I.DistSubTeam_No = @SubTeam_No AND II.Default_Identifier = 1 AND II.Deleted_Identifier = 0
				  AND NOT EXISTS (
									SELECT * FROM StoreItem SI2 WHERE SI2.Store_No = @DC_Store_No AND SI2.Item_Key = I.Item_Key
								  )

		--Not Available flag is TRUE but OnHand Quantity or Weight is &gt; 0
		INSERT INTO @EXECheckList
			SELECT I.Item_Key, 'The Not Available flag is set to TRUE but quantity on hand is greater than zero'
			FROM Item I
			JOIN ItemIdentifier II ON  II.Item_Key = I.Item_Key
			JOIN OnHand OH ON OH.Item_Key = I.Item_Key
			WHERE I.EXEDistributed = 1 AND I.DistSubTeam_No = @SubTeam_No AND II.Default_Identifier = 1 AND II.Deleted_Identifier = 0 AND dbo.fn_GetDiscontinueStatus(I.Item_Key, NULL, NULL) = 0
				  AND I.Not_Available = 1 AND OH.Store_No = @DC_Store_No AND (OH.Quantity &gt; 0 OR OH.Weight &gt; 0)
			ORDER BY LastReset DESC

		--Not Available flag is FALSE but OnHand Quantity or Weight &lt;= 0
		INSERT INTO @EXECheckList
			SELECT I.Item_Key, 'The Not Available flag is set to FALSE but quantity on hand is less than or equal to zero'
			FROM Item I
			JOIN ItemIdentifier II ON  II.Item_Key = I.Item_Key
			JOIN OnHand OH ON OH.Item_Key = I.Item_Key
			WHERE I.EXEDistributed = 1 AND I.DistSubTeam_No = @SubTeam_No AND II.Default_Identifier = 1 AND II.Deleted_Identifier = 0 AND dbo.fn_GetDiscontinueStatus(I.Item_Key, NULL, NULL) = 0
				  AND I.Not_Available = 0 AND OH.Store_No = @DC_Store_No AND (OH.Quantity &lt;= 0 AND OH.Weight &lt;= 0)
			order by lastreset desc

		--Compare Vendor Packs between DC/External Vendor and DC Vendor/Stores...they should be the same
		DECLARE @DCToExternalVendor TABLE
		(
			Item_Key int,
			VendorPack float
		)

		INSERT INTO @DCToExternalVendor
			SELECT I.Item_Key, vch.package_desc1
			FROM Item I
			JOIN ItemIdentifier II ON  II.Item_Key = I.Item_Key
			JOIN storeitemvendor siv2 on siv2.Item_Key = I.Item_Key
			JOIN VendorCostHistory vch on vch.StoreItemVendorId = siv2.StoreItemVendorId
			WHERE I.EXEDistributed = 1 AND I.SubTeam_No = @SubTeam_No AND II.Default_Identifier = 1 AND  II.Deleted_Identifier = 0 
				  AND vch.VendorCostHistoryId = (SELECT TOP 1 VendorCostHistoryId
												 FROM VendorCostHistory
												 WHERE StoreItemVendorId = dbo.fn_GetStoreItemVendorId(I.Item_Key,@DC_Store_No) 
												 ORDER BY VendorCostHistoryId DESC)
		DECLARE @StoreToDCVendor TABLE
		(
			Item_Key int,
			VendorPack float
		)

		INSERT INTO @StoreToDCVendor
			SELECT I.Item_Key, vch.package_desc1
			FROM Item I
			JOIN ItemIdentifier II ON  II.Item_Key = I.Item_Key
			JOIN storeitemvendor siv2 on siv2.Item_Key = I.Item_Key
			JOIN VendorCostHistory vch on vch.StoreItemVendorId = siv2.StoreItemVendorId
			WHERE I.EXEDistributed = 1 AND I.SubTeam_No = @SubTeam_No AND II.Default_Identifier = 1 AND  II.Deleted_Identifier = 0 
				  AND vch.VendorCostHistoryId = (SELECT TOP 1 VendorCostHistoryId
												 FROM VendorCostHistory
												 WHERE StoreItemVendorId = dbo.fn_GetStoreItemVendorId(I.Item_Key,@Store_No) 
												 ORDER BY VendorCostHistoryId DESC)

		INSERT INTO @EXECheckList
			SELECT DCEV.Item_Key, 'The Vendor Pack between the DC and External Vendor and the Vendor Pack between the DC and the Stores must match'
			FROM @DCToExternalVendor DCEV 
			JOIN @StoreToDCVendor SDCV ON SDCV.Item_Key = DCEV.item_key
			WHERE DCEV.VendorPack &lt;&gt; SDCV.VendorPack


		--Deliver results
		SELECT II.Identifier, I.Item_Description AS ItemDescription, CHK.Error
		FROM @EXECheckList CHK
		JOIN ItemIdentifier II ON  II.Item_Key = CHK.Item_Key
		JOIN ITEM I on I.Item_Key = II.Item_Key
		WHERE II.Default_Identifier = 1
		ORDER BY II.Identifier</CommandText>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
      <Fields>
        <Field Name="identifier">
          <DataField>Identifier</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="itemdescription">
          <DataField>ItemDescription</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="error">
          <DataField>Error</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
  </DataSets>
  <ReportParameters>
    <ReportParameter Name="SubTeam_No">
      <DataType>String</DataType>
      <AllowBlank>true</AllowBlank>
      <Prompt>SubTeam Number:</Prompt>
    </ReportParameter>
    <ReportParameter Name="DC_Store_No">
      <DataType>String</DataType>
      <Prompt>DC Store Number:</Prompt>
    </ReportParameter>
    <ReportParameter Name="DC_Vendor_Id">
      <DataType>String</DataType>
      <Prompt>DC Vendor ID:</Prompt>
    </ReportParameter>
    <ReportParameter Name="Store_No">
      <DataType>String</DataType>
      <Prompt>Store Number:</Prompt>
    </ReportParameter>
  </ReportParameters>
  <Language>en-US</Language>
  <ConsumeContainerWhitespace>true</ConsumeContainerWhitespace>
  <rd:ReportUnitType>Inch</rd:ReportUnitType>
  <rd:ReportID>efc4be83-8eb3-4d5b-b738-d3e3c680a021</rd:ReportID>
</Report>